<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zlatoforyou | Madurai</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700&family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #fcfaf7; }
        .brand-font { font-family: 'Cinzel', serif; }
        .bg-maroon { background-color: #800000; }
        .gold-border { border-bottom: 4px solid #D4AF37; }
        .hallmark-badge { background: #D4AF37; color: #800000; font-size: 8px; font-weight: 800; padding: 2px 6px; border-radius: 4px; display: inline-flex; align-items: center; gap: 3px; }
    </style>
</head>
<body class="p-4 md:p-8">

    <div class="max-w-2xl mx-auto bg-white shadow-2xl rounded-2xl overflow-hidden border border-gray-100">
        <div class="bg-maroon p-6 text-white text-center gold-border">
            <h1 class="brand-font text-3xl md:text-5xl tracking-widest text-[#D4AF37] mb-1 uppercase">ZLATOFORYOU</h1>
            <div class="flex justify-center items-center gap-3 mb-4">
                <span id="currentDate" class="text-[10px] uppercase opacity-80 tracking-widest font-bold">
                    <script>document.write(new Date().toLocaleDateString('en-IN', { day:'2-digit', month:'short', year:'numeric' }));</script>
                </span>
                <span class="hallmark-badge">BIS 916 HALLMARK</span>
            </div>
            
            <div class="grid grid-cols-3 gap-2">
                <div class="bg-white/10 p-2 rounded-lg border border-white/10"><p class="text-[9px] uppercase font-bold text-yellow-200">24K Gold</p><p id="p24k" class="text-lg font-bold tracking-tighter">...</p></div>
                <div class="bg-white/10 p-2 rounded-lg border border-white/10 relative"><p class="text-[9px] uppercase font-bold text-yellow-200">22K Gold</p><p id="p22k" class="text-lg font-bold tracking-tighter">...</p><p id="diff" class="text-[9px] text-green-400 font-bold"></p></div>
                <div class="bg-white/10 p-2 rounded-lg border border-white/10"><p class="text-[9px] uppercase font-bold text-gray-300">Silver (1g)</p><p id="psil" class="text-lg font-bold tracking-tighter">...</p></div>
            </div>
        </div>

        <form id="enquiryForm" class="p-6 space-y-5">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div><label class="block text-xs font-bold text-gray-900 uppercase">Customer Name *</label><input type="text" id="customerName" required class="w-full mt-1 p-3 border border-gray-400 rounded-md outline-none"></div>
                <div><label class="block text-xs font-bold text-gray-900 uppercase">WhatsApp Number *</label><input type="tel" id="mobile" pattern="[0-9]{10}" maxlength="10" placeholder="9876543210" required class="w-full mt-1 p-3 border border-gray-400 rounded-md outline-none"></div>
            </div>

            <div><label class="block text-xs font-bold text-gray-900 uppercase">Email ID (Optional)</label><input type="email" id="email" class="w-full mt-1 p-3 border border-gray-400 rounded-md outline-none"></div>

            <div class="flex gap-6 items-center"><span class="text-xs font-bold text-gray-900 uppercase">Metal:</span>
                <label class="flex items-center cursor-pointer"><input type="radio" name="metal" value="Gold" checked class="accent-red-800"><span class="ml-2 text-sm font-bold text-gray-800">Gold</span></label>
                <label class="flex items-center"><input type="radio" name="metal" value="Silver" class="accent-red-800"><span class="ml-2 text-sm font-bold text-gray-800">Silver</span></label>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div><label class="block text-xs font-bold text-gray-900 uppercase">Ornament Design *</label>
                    <select id="design" required class="w-full mt-1 p-3 border border-gray-400 rounded-md bg-white outline-none">
                        <option value="" disabled selected>-- Select Design --</option>
                        <option>Chain</option><option>Necklace</option><option>Ring</option><option>Bracelet</option><option>Bangle</option><option value="Other">Other</option>
                    </select>
                </div>
                <div><label class="block text-xs font-bold text-gray-900 uppercase">Weight (Grams) *</label><input type="number" id="weight" step="0.01" required placeholder="0.00" class="w-full mt-1 p-3 border border-gray-400 rounded-md outline-none"></div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div><label class="block text-xs font-bold text-gray-900 uppercase">Size / Length (Optional)</label><input type="text" id="size" placeholder="e.g. 18 inch" class="w-full mt-1 p-3 border border-gray-400 rounded-md outline-none"></div>
                <div><label class="block text-xs font-bold text-gray-900 uppercase">Timeline *</label>
                    <select id="timeline" class="w-full mt-1 p-3 border border-gray-400 rounded-md bg-white outline-none"><option>1-2 Weeks</option><option>No Hurry</option></select>
                </div>
            </div>

            <div><label class="block text-xs font-bold text-gray-900 uppercase">Notes (Optional)</label><textarea id="notes" rows="2" placeholder="Instructions..." class="w-full p-3 border border-gray-400 rounded-md outline-none"></textarea></div>

            <button type="submit" id="submitBtn" class="w-full bg-maroon text-white font-bold py-4 rounded-md shadow-lg uppercase tracking-widest hover:bg-black transition-all">Submit Enquiry</button>
        </form>

        <div id="successMsg" class="hidden p-10 text-center space-y-6">
            <div class="text-6xl">✨</div>
            <h2 class="brand-font text-2xl font-bold text-gray-800">Enquiry Logged</h2>
            <div class="flex flex-col gap-3">
                <button onclick="downloadPDF()" class="w-full bg-maroon text-white font-bold py-4 rounded-full">Download PDF</button>
                <a id="waButton" href="#" target="_blank" class="block w-full bg-green-600 text-white font-bold py-4 rounded-full">WhatsApp Chat</a>
                <button onclick="location.reload()" class="text-gray-500 font-bold py-2">Submit New Form</button>
            </div>
        </div>
    </div>

    <script>
        const myWhatsAppNumber = "919087526286"; 
        const scriptUrl = "https://script.google.com/macros/s/AKfycbzG-IUItZtf2CkTenAWDJTSpnZrf_TrKCBld0Om7n-K2zPqC5YwAzm5yrXZP1hFx6ZA5A/exec"; 

        window.onload = async () => {
            try {
                const res = await fetch(scriptUrl + "?getPrices=true");
                const d = await res.json();
                if(d.success) {
                    document.getElementById('p24k').innerText = `₹${d.gold24k}`;
                    document.getElementById('p22k').innerText = `₹${d.gold22k}`;
                    document.getElementById('psil').innerText = `₹${d.silver1g}`;
                    document.getElementById('diff').innerText = d.difference;
                    if(d.date) document.getElementById('currentDate').innerText = d.date;
                }
            } catch(e) { 
                console.log("Prices loading via fallback.");
                document.getElementById('p24k').innerText = "₹16,255";
                document.getElementById('p22k').innerText = "₹14,900";
                document.getElementById('psil').innerText = "₹320.00";
            }
        };

        function downloadPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            doc.setFillColor(128, 0, 0); doc.rect(0, 0, 210, 40, 'F');
            doc.setTextColor(212, 175, 55); doc.setFontSize(22); doc.text("ZLATOFORYOU", 105, 25, { align: "center" });
            doc.setTextColor(0, 0, 0); doc.setFontSize(12);
            doc.text(`Customer: ${document.getElementById('customerName').value}`, 20, 60);
            doc.text(`Metal: ${document.querySelector('input[name="metal"]:checked').value}`, 20, 70);
            doc.text(`Design: ${document.getElementById('design').value}`, 20, 80);
            doc.text(`Weight: ${document.getElementById('weight').value}g`, 20, 90);
            doc.save("Zlato_Enquiry.pdf");
        }

        document.getElementById('enquiryForm').addEventListener('submit', async (e) => {
    e.preventDefault();
    const btn = document.getElementById('submitBtn');
    btn.innerText = "Processing...";
    btn.disabled = true;

    const payload = { 
        customerName: document.getElementById('customerName').value, 
        mobile: document.getElementById('mobile').value,
        email: document.getElementById('email').value, 
        metal: document.querySelector('input[name="metal"]:checked').value,
        design: document.getElementById('design').value, 
        weight: document.getElementById('weight').value,
        size: document.getElementById('size').value, 
        timeline: document.getElementById('timeline').value, 
        notes: document.getElementById('notes').value
    };

    try {
        // mode: 'no-cors' allows the request to reach the /dev URL without a CORS error
        await fetch(scriptUrl, { 
            method: 'POST', 
            mode: 'no-cors', 
            cache: 'no-cache',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(payload) 
        });
        
        // With 'no-cors', we won't get a 'success' response back, 
        // so we proceed to the success screen automatically.
        const waText = `*Enquiry from Zlatoforyou*%0A*Name:* ${payload.customerName}%0A*Item:* ${payload.design}`;
        document.getElementById('waButton').href = `https://wa.me/${myWhatsAppNumber}?text=${waText}`;
        document.getElementById('enquiryForm').classList.add('hidden');
        document.getElementById('successMsg').classList.remove('hidden');

    } catch (err) { 
        console.error("Browser Blocked Request:", err);
        alert("Request blocked by browser. Ensure you are logged into Google in this tab.");
        btn.disabled = false;
        btn.innerText = "Submit Enquiry";
    }
});
    </script>
</body>

</html>
